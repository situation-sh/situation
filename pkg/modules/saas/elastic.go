package saas

import (
	"net"

	"github.com/situation-sh/situation/pkg/models"
)

func init() {
	registerDetector(&ElasticDetector{
		// curl -s 'https://ips.cld.elstc.co/'|jq|grep -oE '([0-9]+[.]){3}[0-9]+[/][0-9]+'|sort|uniq|awk '{print "mustParseCIDR(\""$1"\"),"}'
		nets: []*net.IPNet{
			mustParseCIDR("13.113.78.243/32"),
			mustParseCIDR("13.125.190.79/32"),
			mustParseCIDR("13.125.59.255/32"),
			mustParseCIDR("13.213.189.196/32"),
			mustParseCIDR("13.232.14.214/32"),
			mustParseCIDR("13.244.127.237/32"),
			mustParseCIDR("13.244.188.161/32"),
			mustParseCIDR("13.244.83.103/32"),
			mustParseCIDR("13.245.177.187/32"),
			mustParseCIDR("13.246.103.117/32"),
			mustParseCIDR("13.247.6.0/32"),
			mustParseCIDR("13.250.239.193/32"),
			mustParseCIDR("13.37.60.15/32"),
			mustParseCIDR("13.48.223.102/32"),
			mustParseCIDR("13.48.240.107/32"),
			mustParseCIDR("13.49.169.54/32"),
			mustParseCIDR("13.49.189.236/32"),
			mustParseCIDR("13.49.58.23/32"),
			mustParseCIDR("13.50.118.15/32"),
			mustParseCIDR("13.50.65.52/32"),
			mustParseCIDR("13.52.141.4/32"),
			mustParseCIDR("13.53.59.139/32"),
			mustParseCIDR("15.157.76.253/32"),
			mustParseCIDR("15.160.34.37/32"),
			mustParseCIDR("15.160.6.70/32"),
			mustParseCIDR("15.161.17.197/32"),
			mustParseCIDR("15.184.168.189/32"),
			mustParseCIDR("15.184.181.106/32"),
			mustParseCIDR("15.185.47.50/32"),
			mustParseCIDR("15.185.57.135/32"),
			mustParseCIDR("15.188.130.78/32"),
			mustParseCIDR("15.188.24.32/32"),
			mustParseCIDR("15.188.92.209/32"),
			mustParseCIDR("15.222.165.33/32"),
			mustParseCIDR("15.222.225.230/32"),
			mustParseCIDR("15.223.144.232/32"),
			mustParseCIDR("15.236.197.16/32"),
			mustParseCIDR("16.162.111.210/32"),
			mustParseCIDR("16.171.223.26/32"),
			mustParseCIDR("16.24.2.138/32"),
			mustParseCIDR("16.24.57.138/32"),
			mustParseCIDR("16.62.222.57/32"),
			mustParseCIDR("16.63.105.171/32"),
			mustParseCIDR("16.63.147.136/32"),
			mustParseCIDR("16.63.168.93/32"),
			mustParseCIDR("16.63.179.255/32"),
			mustParseCIDR("16.63.191.15/32"),
			mustParseCIDR("16.63.192.79/32"),
			mustParseCIDR("16.63.194.90/32"),
			mustParseCIDR("16.63.212.233/32"),
			mustParseCIDR("16.63.227.168/32"),
			mustParseCIDR("16.63.38.67/32"),
			mustParseCIDR("16.63.79.216/32"),
			mustParseCIDR("174.129.140.127/32"),
			mustParseCIDR("177.71.163.0/32"),
			mustParseCIDR("177.71.199.95/32"),
			mustParseCIDR("18.102.155.69/32"),
			mustParseCIDR("18.102.167.235/32"),
			mustParseCIDR("18.130.189.101/32"),
			mustParseCIDR("18.132.121.72/32"),
			mustParseCIDR("18.140.120.144/32"),
			mustParseCIDR("18.140.151.160/32"),
			mustParseCIDR("18.140.166.171/32"),
			mustParseCIDR("18.144.119.143/32"),
			mustParseCIDR("18.163.21.192/32"),
			mustParseCIDR("18.166.191.36/32"),
			mustParseCIDR("18.166.202.27/32"),
			mustParseCIDR("18.166.240.84/32"),
			mustParseCIDR("18.195.185.112/32"),
			mustParseCIDR("18.196.39.128/32"),
			mustParseCIDR("18.204.141.221/32"),
			mustParseCIDR("18.214.168.74/32"),
			mustParseCIDR("18.224.115.127/32"),
			mustParseCIDR("18.229.203.210/32"),
			mustParseCIDR("18.230.171.91/32"),
			mustParseCIDR("18.231.50.219/32"),
			mustParseCIDR("191.235.42.140/32"),
			mustParseCIDR("191.237.203.107/32"),
			mustParseCIDR("20.11.89.160/28"),
			mustParseCIDR("20.11.89.38/32"),
			mustParseCIDR("20.11.89.45/32"),
			mustParseCIDR("20.120.187.208/28"),
			mustParseCIDR("20.122.252.32/28"),
			mustParseCIDR("20.166.141.152/32"),
			mustParseCIDR("20.166.141.217/32"),
			mustParseCIDR("20.166.142.32/28"),
			mustParseCIDR("20.166.230.0/28"),
			mustParseCIDR("20.175.167.16/28"),
			mustParseCIDR("20.175.190.160/28"),
			mustParseCIDR("20.19.105.250/32"),
			mustParseCIDR("20.19.105.253/32"),
			mustParseCIDR("20.19.107.176/28"),
			mustParseCIDR("20.199.61.32/28"),
			mustParseCIDR("20.200.74.151/32"),
			mustParseCIDR("20.204.247.135/32"),
			mustParseCIDR("20.206.174.0/28"),
			mustParseCIDR("20.206.192.88/32"),
			mustParseCIDR("20.207.67.149/32"),
			mustParseCIDR("20.207.68.175/32"),
			mustParseCIDR("20.207.71.16/28"),
			mustParseCIDR("20.210.24.182/32"),
			mustParseCIDR("20.210.24.191/32"),
			mustParseCIDR("20.210.74.176/28"),
			mustParseCIDR("20.212.100.163/32"),
			mustParseCIDR("20.212.100.183/32"),
			mustParseCIDR("20.219.180.0/28"),
			mustParseCIDR("20.220.155.206/32"),
			mustParseCIDR("20.220.156.147/32"),
			mustParseCIDR("20.221.84.176/32"),
			mustParseCIDR("20.221.84.187/32"),
			mustParseCIDR("20.221.86.128/28"),
			mustParseCIDR("20.226.152.144/28"),
			mustParseCIDR("20.232.7.106/32"),
			mustParseCIDR("20.232.7.131/32"),
			mustParseCIDR("20.236.170.176/28"),
			mustParseCIDR("20.246.200.80/28"),
			mustParseCIDR("20.247.254.112/28"),
			mustParseCIDR("20.248.220.224/28"),
			mustParseCIDR("20.27.131.128/28"),
			mustParseCIDR("20.43.182.130/32"),
			mustParseCIDR("20.44.142.197/32"),
			mustParseCIDR("20.50.174.29/32"),
			mustParseCIDR("20.53.85.4/32"),
			mustParseCIDR("20.72.69.222/32"),
			mustParseCIDR("20.75.187.96/28"),
			mustParseCIDR("20.76.141.52/32"),
			mustParseCIDR("20.76.143.246/32"),
			mustParseCIDR("20.76.89.96/28"),
			mustParseCIDR("20.77.149.224/28"),
			mustParseCIDR("20.77.149.246/32"),
			mustParseCIDR("20.77.149.249/32"),
			mustParseCIDR("20.8.247.112/28"),
			mustParseCIDR("20.87.103.96/28"),
			mustParseCIDR("20.87.200.121/32"),
			mustParseCIDR("20.87.203.77/32"),
			mustParseCIDR("20.87.225.199/32"),
			mustParseCIDR("20.87.225.240/28"),
			mustParseCIDR("20.88.237.166/32"),
			mustParseCIDR("20.88.237.171/32"),
			mustParseCIDR("20.94.24.213/32"),
			mustParseCIDR("20.94.31.240/28"),
			mustParseCIDR("20.97.100.144/28"),
			mustParseCIDR("20.99.204.156/32"),
			mustParseCIDR("20.99.205.255/32"),
			mustParseCIDR("3.106.79.70/32"),
			mustParseCIDR("3.109.250.190/32"),
			mustParseCIDR("3.113.89.174/32"),
			mustParseCIDR("3.12.225.34/32"),
			mustParseCIDR("3.133.63.189/32"),
			mustParseCIDR("3.15.96.103/32"),
			mustParseCIDR("3.19.145.84/32"),
			mustParseCIDR("3.21.173.192/32"),
			mustParseCIDR("3.212.44.6/32"),
			mustParseCIDR("3.214.231.41/32"),
			mustParseCIDR("3.215.12.84/32"),
			mustParseCIDR("3.218.187.232/32"),
			mustParseCIDR("3.220.12.171/32"),
			mustParseCIDR("3.223.37.231/32"),
			mustParseCIDR("3.234.152.120/32"),
			mustParseCIDR("3.34.10.233/32"),
			mustParseCIDR("34.101.88.19/32"),
			mustParseCIDR("34.107.117.83/32"),
			mustParseCIDR("34.155.97.253/32"),
			mustParseCIDR("34.165.25.236/32"),
			mustParseCIDR("34.198.138.2/32"),
			mustParseCIDR("34.199.113.58/32"),
			mustParseCIDR("34.205.88.186/32"),
			mustParseCIDR("34.218.154.173/32"),
			mustParseCIDR("34.223.33.250/32"),
			mustParseCIDR("34.231.108.253/32"),
			mustParseCIDR("34.234.143.15/32"),
			mustParseCIDR("34.237.57.214/32"),
			mustParseCIDR("34.64.225.166/32"),
			mustParseCIDR("34.80.121.179/32"),
			mustParseCIDR("34.83.110.184/32"),
			mustParseCIDR("34.85.47.11/32"),
			mustParseCIDR("34.86.124.173/32"),
			mustParseCIDR("34.87.4.75/32"),
			mustParseCIDR("34.89.12.12/32"),
			mustParseCIDR("34.91.16.60/32"),
			mustParseCIDR("35.152.85.157/32"),
			mustParseCIDR("35.168.128.28/32"),
			mustParseCIDR("35.171.109.44/32"),
			mustParseCIDR("35.177.250.1/32"),
			mustParseCIDR("35.181.88.243/32"),
			mustParseCIDR("35.189.34.185/32"),
			mustParseCIDR("35.193.143.25/32"),
			mustParseCIDR("35.195.130.253/32"),
			mustParseCIDR("35.200.182.115/32"),
			mustParseCIDR("35.203.107.190/32"),
			mustParseCIDR("35.228.67.42/32"),
			mustParseCIDR("35.231.119.5/32"),
			mustParseCIDR("35.247.211.164/32"),
			mustParseCIDR("35.79.187.13/32"),
			mustParseCIDR("3.6.236.251/32"),
			mustParseCIDR("3.67.111.206/32"),
			mustParseCIDR("3.7.222.167/32"),
			mustParseCIDR("3.77.107.179/32"),
			mustParseCIDR("3.78.35.181/32"),
			mustParseCIDR("3.8.226.98/32"),
			mustParseCIDR("3.9.205.158/32"),
			mustParseCIDR("3.93.116.88/32"),
			mustParseCIDR("3.96.36.166/32"),
			mustParseCIDR("3.98.198.97/32"),
			mustParseCIDR("40.65.235.20/32"),
			mustParseCIDR("4.144.176.32/28"),
			mustParseCIDR("4.234.41.32/28"),
			mustParseCIDR("43.198.237.23/32"),
			mustParseCIDR("43.201.169.98/32"),
			mustParseCIDR("43.202.19.137/32"),
			mustParseCIDR("43.204.156.146/32"),
			mustParseCIDR("44.195.226.190/32"),
			mustParseCIDR("44.210.37.226/32"),
			mustParseCIDR("44.213.199.140/32"),
			mustParseCIDR("44.236.141.40/32"),
			mustParseCIDR("50.18.234.117/32"),
			mustParseCIDR("50.18.36.102/32"),
			mustParseCIDR("51.11.231.229/32"),
			mustParseCIDR("51.143.110.243/32"),
			mustParseCIDR("51.20.200.159/32"),
			mustParseCIDR("51.20.224.157/32"),
			mustParseCIDR("51.20.90.184/32"),
			mustParseCIDR("52.149.51.208/28"),
			mustParseCIDR("52.151.125.244/32"),
			mustParseCIDR("52.152.96.98/32"),
			mustParseCIDR("52.155.221.13/32"),
			mustParseCIDR("52.158.162.229/32"),
			mustParseCIDR("52.189.37.32/28"),
			mustParseCIDR("52.191.218.117/32"),
			mustParseCIDR("52.202.72.126/32"),
			mustParseCIDR("52.204.179.207/32"),
			mustParseCIDR("52.209.213.71/32"),
			mustParseCIDR("52.214.206.186/32"),
			mustParseCIDR("52.37.215.45/32"),
			mustParseCIDR("52.56.90.124/32"),
			mustParseCIDR("52.58.157.134/32"),
			mustParseCIDR("52.62.147.236/32"),
			mustParseCIDR("52.65.241.244/32"),
			mustParseCIDR("52.67.139.204/32"),
			mustParseCIDR("52.67.193.231/32"),
			mustParseCIDR("52.67.198.207/32"),
			mustParseCIDR("52.78.136.207/32"),
			mustParseCIDR("52.8.5.250/32"),
			mustParseCIDR("52.9.183.23/32"),
			mustParseCIDR("54.150.218.6/32"),
			mustParseCIDR("54.160.25.132/32"),
			mustParseCIDR("54.161.173.12/32"),
			mustParseCIDR("54.173.213.121/32"),
			mustParseCIDR("54.176.237.199/32"),
			mustParseCIDR("54.184.179.35/32"),
			mustParseCIDR("54.185.213.33/32"),
			mustParseCIDR("54.195.49.101/32"),
			mustParseCIDR("54.217.203.181/32"),
			mustParseCIDR("54.219.232.5/32"),
			mustParseCIDR("54.233.232.236/32"),
			mustParseCIDR("54.248.251.120/32"),
			mustParseCIDR("54.249.187.33/32"),
			mustParseCIDR("54.252.55.13/32"),
			mustParseCIDR("54.253.145.205/32"),
			mustParseCIDR("54.254.40.164/32"),
			mustParseCIDR("54.76.204.44/32"),
			mustParseCIDR("54.79.174.161/32"),
			mustParseCIDR("54.80.119.44/32"),
			mustParseCIDR("54.94.143.38/32"),
			mustParseCIDR("54.94.65.26/32"),
			mustParseCIDR("54.94.97.162/32"),
			mustParseCIDR("63.32.148.69/32"),
			mustParseCIDR("65.1.228.89/32"),
		},
	})
}

type ElasticDetector struct {
	nets []*net.IPNet
}

func (d *ElasticDetector) Name() string {
	return "Elastic Cloud"
}

func (d *ElasticDetector) Detect(endpoint *models.ApplicationEndpoint) (bool, error) {
	return matchIPRange(endpoint, d.nets)
}
